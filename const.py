#!/bin/sh
# -*- coding: utf-8

import numpy
import wxversion
wxversion.select("2.8")
import wx
import platform
#
from wx.lib.embeddedimage import PyEmbeddedImage 
 
#
# global variables in fu
# About FU constants (see fulib.About())
VERSION='fu-0.4.0'
COPYRIGHT="Copyright (c) 2013-2016, Fu User Group. All rights reserved.\n"
#
FUVER='fu version 0.4.0'
FUMODELVER='fumodel ver.0.2.0 (07Jul2014)'
FMOVIEWERVER='fmoviewer ver.0.4.0 (05Jan2015)'
FUPLOTVER='fuplot ver.0.2.0 (20Feb2014)'
FUTOOLSVER='futools ver.0.1.0 (30Mar2014)'
# GAMESS version
GAMESSVER='FMO Version 4.3 in GAMESS VERSION 1 MAY 2013 (R1)'
# SYSTEM  default 
WINDOWS='windows'
WIN32='win32'
MACOSX='darwin'
SYSTEM=WINDOWS
# height of ComboBox
HCBOX=22

def GetSYSTEM():
    """ get platform """
    return platform.system().lower()
# icons
FUMODELICON='' # icon file name of fumodel 
FMOVIEWERICON='' # icon file name of fmoviewer 
FUPLOTICON=''
FUTOOLSICON=''
FUMODELLOGO=''
FUPLOTLOGO=''
FUTOOLSLOGO=''
# FUFONT
FUFONT=None
#
SETCTRL=None
EXECMENU=None
CONSOLEMESSAGE=None
MDLWIN=None
MESSAGELEVEL=1

MAXSPHERE=55000 # maximum number of sheres on WINDOWS

def SetFUFONT():
    """ set font """
    fontsize=8
    FUFONT=wx.Font(fontsize,wx.FONTFAMILY_DEFAULT,wx.FONTSTYLE_NORMAL,wx.FONTWEIGHT_NORMAL)

EDITOR=''
# for storing fuModel and fuPlot instances
#fum = None
#fup = None
#fuv=None
LOGOWNER='' # owner of the log file
LOGFILE=''  # log file name
LOGDEV=None # log file device

LOGGINGMETHODDIC={}

FUFILEEXT=['.pdb','.ent','.xyz','.xyzs','.xyzfu','.inp','.out','.tin',
           '.frg','.bda','.frm','.fuf','.spl','.drwpic',
           '.dat','.txt','.den','.orb','.cube','.pie',
           '.logging','.result','.filter','.py','.pypy','.pyarch',
           '.gz','.method',
           '.png','.bmp','.jpeg','.pcx','.pnm','.xpm']
# physical consts
PysCon ={'rd2dg' : 57.29577951,
         'dg2rd' : 0.017453292,   'bh2an' : 0.529917724,
         'an2bh' : 1.8870854, 'todeg' : 180.0/numpy.pi,
         'au2ev':27.2113845}

#wfConDic={}
""" element symbol: up to 82-th element (XX is for TER atom in pdb)"""
ElmSbl=['  ',' H','HE','LI','BE',' B',' C',' N',' O',' F','NE',
        'NA','MG','AL','SI',' P',' S','CL','AR',' K','CA',
        'SC','TI',' V','CR','MN','FE','CO','NI','CU','ZN',
        'GA','GE','AS','SE','BR','KR','RB','SR',' Y','ZR',
        'NB','MO','TC','RU','RH','PD','AG','CD','IN','SN',
        'SB','TE',' I','XE','CS','BA','LA','CE','PR','ND',
        'PM','SM','EU','GD','TB','DY','HO','ER','TM','YB',
        'LU','HF','TA',' W','RE','OS','IR','PT','AU','HG',
        'TL','PB','XX',' X','  ','  ','  ','  ','LP','  ', # 'XX' is TER
        '  ','  ','  ','  ','  ','  ','  ','  ','LP','  '] # 'LP or DUMMY for MM

""" element number up to 82-th element """
ElmNmb={' H':1, 'HE':2, 'LI':3,'BE': 4, ' B': 5,
        ' C':6, ' N':7, ' O':8,' F': 9, 'NE':10,
        'NA':11,'MG':12,'AL':13,'SI':14,' P':15,
        ' S':16,'CL':17,'AR':18,'K ':19,'CA':20,
        'SC':21,'TI':22,' V':23,'CR':24,'MN':25,
        'FE':26,'CO':27,'NI':28,'CU':29,'ZN':30,
        'GA':31,'GE':32,'AS':33,'SE':34,'BR':35,
        'KR':36,'RB':37,'SR':38,' Y':39,'ZR':40,
        'NB':41,'MO':42,'TC':43,'RU':44,'RH':45,
        'PD':46,'AG':47,'CD':48,'IN':49,'SN':50,
        'SB':51,'TE':52,' I':53,'XE':54,'CS':55,
        'BA':56,'LA':57,'CE':58,'PR':59,'ND':60,
        'PM':61,'SM':62,'EU':63,'GD':64,'TB':65,
        'DY':66,'HO':67,'ER':68,'TM':69,'YB':70,
        'LU':71,'HF':72,'TA':73,' W':74,'RE':75,
        'OS':76,'IR':77,'PT':78,'AU':79,'HG':80,
        'TL':81,'PB':82,'XX':83 ,' X':84,'  ':0,
        '  ':0, '  ':0, '  ':0 ,'  ':0, '  ':0,
        '  ':0, '  ':0, '  ':0 ,'  ':0, '  ':0,
        '  ':0, '  ':0, '  ':0 ,'LP':99,'  ':0 }
          
""" atomic mass up to 82-th element """
ElmMas={' H':1.008,  'HE':4.003,   'LI':6.941,  'BE':9.012,  ' B':10.811,
        ' C':12.011, ' N':14.007,  ' O':15.999, ' F':18.998, 'NE':20.180,
        'NA':22.990, 'MG':24.305,  'AL':26.982, 'SI':28.086, ' P':30.974,
        ' S':32.065, 'CL':35.453,  'AR':39.948, ' K':39.098, 'CA':40.078,
        'SC':44.956, 'TI':47.867,  ' V':50.942, 'CR':51.996, 'MN':54.938,
        'FE':55.845, 'CO':58.933,  'NI':58.693, 'CU':63.546, 'ZN':65.38,
        'GA':69.723, 'GE':72.64 ,  'AS':74.922, 'SE':78.96 , 'BR':79.904,
        'KR':83.798, 'RB':85.4678, 'SR':87.62,  ' Y':88.906, 'ZR':91.224,
        'NB':92.906, 'MO':95.96,   'TC':98.0  , 'RU':101.07, 'RH':102.905,
        'PD':106.42, 'AG':107.8682,'CD':112.411,'IN':114.818,'SN':118.710,
        'SB':121.760,'TE':127.60,  ' I':126.904,'XE':131.293,'CS':132.905,
        'BA':137.327,'LA':138.905, 'CE':140.116,'PR':140.908,'ND':144.242,
        'PM':145.0  ,'SM':150.36,  'EU':151.964,'GD':157.25, 'TB':158.925,
        'DY':162.500,'HO':164.930, 'ER':167.259,'TM':168.934,'YB':173.054,
        'LU':174.967,'HF':178.49,  'TA':180.947,' W':183.84, 'RE':186.207,
        'OS':190.23, 'IR':192.217, 'PT':195.084,'AU':196.967,'HG':200.59,
        'TL':204.383,'PB':207.2,'XX':0.0,'D ':2.0141}  # 'D ': deuterium

# covalent radii
""" Caution! unknown values are arbitrary set to 1.5 angstroms """ 
ElmCov={' H':0.3,  'HE':1.5,  'LI':1.225, 'BE':1.06, ' B':0.88,
        #' C':0.77, ' N':0.7,  ' O':0.66,  ' F':0.64, 'NE':1.5,
        # for modeling ps2, the following parameters are tentatively modified
        ' C':0.77, ' N':0.76,  ' O':0.70,  ' F':0.64, 'NE':1.5, 
        'NA':1.572,'MG':1.364,'AL':1.248, 'SI':1.173,' P':1.1,
        ' S':1.04, 'CL':0.99, 'AR':1.5,   ' K':2.025,'CA':1.736,
        'SC':1.439,'TI':1.324,' V':1.224, 'CR':1.176,'MN':1.171,
        'FE':1.165,'CO':1.162,'NI':1.154, 'CU':1.173,'ZN':1.249,
        'GA':1.245,'GE':1.223,'AS':1.18,  'SE':1.14, 'BR':1.11,
        'KR':1.5,  'RB':2.16, 'SR':1.914, ' Y':1.616,'ZR':1.454,
        'NB':1.342,'MO':1.296,'TC':1.271, 'RU':1.246,'RH':1.252,
        'PD':1.283,'AG':1.33, 'CD':1.413, 'IN':1.497,'SN':1.399,
        'SB':1.36, 'TE':1.32, ' I':1.28,  'XE':1.5,  'CS':2.35,
        'BA':1.981,'LA':1.69, 'CE':1.5,   'PR':1.5,  'ND':1.5,
        ' D':0.3,  ' X':0.00,'XX':0.0, '??':0.0}
            #from 'PM' 1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,
            # 1.442,1.442,1.343,1.304,1.283,1.26,1.265,1.295,1.336,1.44,
            # 1.549,1.538,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,
            # 1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5/
# van-der-waals radii
""" Caution! unknown values are arbitrary set to 1.8 angstroms """
VdwRad={' H':1.20,'HE':1.20,'LI':1.37,'BE':1.45,' B':1.45,
        ' C':1.50,' N':1.50,' O':1.40,' F':1.35,'NE':1.30,
        'NA':1.57,'MG':1.36,'AL':1.25,'SI':1.17,' P':1.80,
        ' S':1.75,'CL':1.70,'AR':1.80,' K':1.80,'CA':1.80,
        'SC':1.80,'TI':1.80,'V ':1.80,'CR':1.80,'MN':1.80,
        'FE':1.80,'CO':1.80,'NI':1.80,'CU':1.80,'ZN':1.80,
        'GA':1.80,'GE':1.80,'AS':1.80,'SE':1.80,'BR':1.80,
        'KR':1.80,'RB':1.80,'SR':1.80,' Y':1.80,'ZR':1.80,
        'NB':1.80,'MO':1.80,'TC':1.80,'RU':1.80,'RH':1.80,
        'PD':1.80,'AG':1.80,'CD':1.80,'IN':1.80,'SN':1.80,
        'SB':1.80,'TE':1.80,' I':1.80,'XE':1.80,'CS':1.80,
        'BA':1.80,'LA':1.80,'CE':1.80,'PR':1.80,'ND':1.80,
        'ZZ':1.80,'XX':0.0} # 'ZZ': unkown, 'XX': TER Atom

ElmValence={' H':1,'HE':0,'LI':1,'BE':1,' B':1,
        ' C':4,' N':3,' O':2,' F':1,'NE':0,
        'NA':1,'MG':1,'AL':1,'SI':4,' P':3,
        ' S':2,'CL':1,'AR':0,' K':1,'CA':1, 
        'XX':0,'ZZ':0,'XX':0} # 'ZZ': unkown, 

ElmBonds={' H':[1],'HE':[0],'LI':[1],'BE':[1],' B':[1],
        ' C':[1,2,3,4],' N':[2,3,4],' O':[1,2],' F':[1],'NE':[0],
        'NA':[1],'MG':[1],'AL':[1],'SI':[1,2,3,4],' P':[3],
        ' S':[2],'CL':[1],'AR':[0],' K':[1],'CA':[1] } 
# Default model parameters in Atom class
DefaultAtomParam={'AtmRad':0.4,'BondThickness':2,'Model':0}
# color in HSV color model (H,S,V) H:0-360, S=0-1, V=0-1
HSVCol={'red':(0,1.0,1.0),'yellow':(60,1.0,1.0),'green':(120,1.0,1.0),
        'cyan':(180,1.0,1.0),'blue':(240,1.0,1.0),'magenta':(300,1.0,1.0),
        'darkgreen':(120,0.01,0.5),'brown':(0,1.0,0.5),'orange':(35,1.0,1.0),
        'purple':(280,1.0,1.0),'rose':(320,1.0,1.0),'white':(361,0.01,1.0),
        'lightgray':(360,0.01,0.8),'darkgray':(360,0.01,0.5),
        'gray':(361,0.01,0.65),'black':(361,0.01,0.0) }

#ElmHSVCol={' H':(361,0.01,0.7),' C':(361,0.01,0.6),' O':HSVCol['red'],' N':(210,1.0,1.0),
#           ' S':HSVCol['yellow'], 'XX':HSVCol['black'],'??':(0,0.01,0.5),'ZZ':(0,1.0,0.5),
#           'CA':(120,1.0,0.5), # V gradient 0.5-0.35
#           'MN':HSVCol['cyan']}
RGBColor={'red':[1.0,0.0,0.0,1.0],'green':[0.0,1.0,0.0,1.0],
          'blue':[0.0,0.0,1.0,1.0],'yellow':[1.0,1.0,0.0,1.0],
          'black':[0.0,0.0,0.0,1.0],'navy':[0.0,0.0,0.5,1.0],
          'white':[1.0,1.0,1.0,1.0],'aqua':[0.0,1.0,1.0,1.0],
          'fuchsia':[1.0,0.0,1.0,1.0],'teal':[0.0,0.5,0.5,1.0],
          'cyan':[0.0,1.0,1.0,1.0],'magenta':[1.0,0.0,0.6,1.0],
          'orange':[1.0,0.4,0.0,1.0],'brown':[0.5,0.0,0.0,1.0],
          'purple':[0.6,0.0,1.0,1.0],'gray':[0.6,0.6,0.6,1.0],
          'pink':[0.90,0.44,0.72,1.0],'gold':[1.0,0.8,0.0,1.0],
          'black':[0.0,0.0,0.0,1.0]}
# windows RGB values
RGBColor255={'red':[255,0,0],'green':[0,255,0],'blue':[0,0,255],
          'yellow':[255,255,0],'greenyellow':[20,255,50],
          'lemonchiffon':[255,250,205],'black':[0,0,0],'navy':[0,0,128],
          'white':[255,255,255],'aqua':[0,255,255],'fuchsia':[255,0,255],
          'teal':[0,128,128],'cyan':[0,255,255],'magenta':[255,0,152],
          'orange':[255,100,0],'brown':[128,0,0],'purple':[152,0,255],
          'gray':[152,152,152],'gray01':[200,200,200],'pink':[230,112,184],
          'gold':[255,204,0],'black':[0,0,0],'olive':[128,128,0],
          'darkkhaki':[190,182,108]}

LayerCol = {0:[1.0,1.0,0.0,1.0], # FMO layer 1, yellow (0 is not used)
            1:[1.0,1.0,0.0,1.0], # FMO layer 1, yellow
            2:[1.0,0.0,0.6,1.0], # FMO layer 2,magenta
            3:[1.0,0.4,0.0,1.0], # FMO layer 3,orange
            4:[0.0,0.0,1.0,1.0], # FMO layer 4, blue
            5:[1.0,0.0,0.0,1.0], # FMO layer 5, red
           11:[0.0,1.0,1.0,1.0], # EFP layer,cyan
           12:[1.0,1.0,1.0,1.0] , # MM in IMOMM layer          }    
           }
# element color in RGBA
ElmCol = {' H':[0.8,0.8,0.8,1.0],
          ' C':[0.5,0.5,0.5,1.0],
          ' N':[0.5,0.5,1.0,1.0],
          ' O':[1.0,0.0,0.0,1.0],
          ' S':[1.0,1.0,0.0,1.0],
          'CL':[0.0,1.0,1.0,1.0], # cyan ... anion color
          'NA':[1.0,1.0,0.0,1.0], # yellow ... cation color
          'MG':[1.0,1.0,0.0,1.0], # yellow
          'MN':[1.0,1.0,0.0,1.0], # yellow
          'FE':[1.0,1.0,0.0,1.0], # yellow          
          'CA':[0.5,0.0,0.0,1.0], # brown,[1.0,1.0,0.0,1.0], # yellow
          'ZZ':[0.5,0.5,0.5,1.0], # unkown element
          'XX':[0.0,0.0,0.0,1.0], # black, TER atom
          'SL':[0.0,1.0,0.0,1.0], # green, selected atom
          'EV':[1.0,0.0,0.6,1.0], # magenta,environment atoms
          'EX':[0.0,1.0,1.0,1.0], # cyan, extra bond
          '??':[1.0,0.0,0.6,1.0]  # unidentified atom
         }    
# rainbow color: #FF8000,#FF8000,#FFFF00,#009900,#0000FF,#0000CC,#6600CC
ChainCol={0:[1.0,0.0,0.0,1.0],1:[1.0,0.66,1.0,1.0],2:[1.0,1.0,0.0,1.0],
          3:[0.0,0.60,0.0,1.0],4:[0.0,0.0,1.0,1.0],5:[0.0,0.0,0.80,1.0],
          6:[0.40,0.0,0.80,1.0],7:[1.0,1.0,1.0,1.0]}
# rainbow color: #FF8000,#FF8000,#FFFF00,#009900,#0000FF,#0000CC,#6600CC
GroupCol={0:[1.0,0.0,0.0,1.0],1:[1.0,0.66,1.0,1.0],2:[1.0,1.0,0.0,1.0],
          3:[0.0,0.60,0.0,1.0],4:[0.0,0.0,1.0,1.0],5:[0.0,0.0,0.80,1.0],
          6:[0.40,0.0,0.80,1.0],7:[1.0,1.0,1.0,1.0]}
# rainbow color: #FF8000,#FF8000,#FFFF00,#009900,#0000FF,#0000CC,#6600CC
ResidueCol={0:[1.0,0.0,0.0,1.0],1:[1.0,0.66,1.0,1.0],2:[1.0,1.0,0.0,1.0],
          3:[0.0,0.60,0.0,1.0],4:[0.0,0.0,1.0,1.0],5:[0.0,0.0,0.80,1.0],
          6:[0.40,0.0,0.80,1.0],7:[1.0,1.0,1.0,1.0],
          8:[1.0,0.0,0.0,1.0],9:[1.0,0.66,1.0,1.0],10:[1.0,1.0,0.0,1.0],
          11:[0.0,0.60,0.0,1.0],12:[0.0,0.0,1.0,1.0],13:[0.0,0.0,0.80,1.0],
          14:[0.40,0.0,0.80,1.0],15:[1.0,1.0,1.0,1.0],
          16:[1.0,0.0,0.0,1.0],17:[1.0,0.66,1.0,1.0],18:[1.0,1.0,0.0,1.0],
          19:[0.0,0.60,0.0,1.0],20:[0.0,0.0,1.0,1.0],21:[0.0,0.0,0.80,1.0],
          22:[0.40,0.0,0.80,1.0],23:[1.0,1.0,1.0,1.0],
          24:[1.0,0.0,0.0,1.0]}
# rainbow color: #FF8000,#FF8000,#FFFF00,#009900,#0000FF,#0000CC,#6600CC
FragmentCol={0:[1.0,0.0,0.0,1.0],1:[1.0,0.66,1.0,1.0],2:[1.0,1.0,0.0,1.0],
          3:[0.0,0.60,0.0,1.0],4:[0.5,0.5,1.0,1.0],5:[0.43,0.90,0.99,1.0],
          6:[0.40,0.0,0.80,1.0],7:[1.0,1.0,1.0,1.0]}

AmiRes3={'GLY':1,'ALA':2,'VAL':3,'PHE':4,'ILE':5,
         'LEU':6,'PRO':7,'MET':8,'ASP':9,'GLU':10,
         'LYS':11,'ARG':12,'SER':13,'THR':14,'TYR':15,
         'CYS':16,'ASN':17,'GLN':18,'HIS':19,'TRP':20,
         'HIP':21,'HIE':22,'HID':23,'CYX':24  }
AmiRes1={'G':1, 'A':2, 'V':3, 'F':4, 'I':5,
         'L':6, 'P':7,' M':8, 'D':9, 'E':10,
         'K':11,'R':12,'S':13,'T':14,'Y':15,
         'C':16,'N':17,'Q':18,'H':19,'W':20            }
WaterRes=['HOH','WAT','H2O','DOD']
HisRes=['HIS','HIP','HID','HIE']
CysRes=['CYS','CYX']
# 'A B' type: standard, maximum, minimum (these are arbitary set by the auther.
# shoud be replaced with more reasonable data. 
HBndLen={'N N ':[3.0,2.5,3.3],'N O ':[3.0,2.5,3.3],'N S ':[3.3,2.8,3.6],
         'O O ':[3.0,2.5,3.3],'O S ':[3.3,2.8,3.6],'S S ':[3.6,3.0,3.8] }

CHPILen={}

CovBndLen={' H C':[1.09,1.08,1.07],' H N':[1.01,1.01],' H O':[0.96,0.96],
           ' H S':[1.33],
           ' N N':[1.45],' C C':[1.54,1.35,1.24,1.40],' C N':[1.47,1.33],
           ' C O':[1.43,1.23],' O O':[1.32],' C S':[1.81],' S S':[2.05]}
#RDEL/0.15/,DSS/0.22/
# LJ potential parameters
LJParams={' H':[1.20,0.03],'HE':[1.30,0.02],' B':[1.90,0.04],
          ' C':[1.75,0.07],' N':[1.60,0.17],' O':[1.50,0.21],
          ' F':[1.45,0.06],'NE':[1.40,0.07],'SI':[2.00,0.15],
          ' P':[1.90,0.20],' S':[1.80,0.25],'CL':[1.70,0.30],
          'AR':[1.70,0.23],'BR':[2.30,0.09],'KR':[1.80,0.31],
          ' I':[2.70,0.07],'XE':[1.95,0.43]}

AmiResH={'ALA':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['3A1',[' HB1',' HB2',' HB3'],[' CA '],1.090]},
         'GLY':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['2A1',[' HA2',' HA3'],[' N  ',' C  '],1.090]},
         'SER':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' OG '],1.090],
                ' OG ':['1A3',[' HG '],[' CB ',' CA '],0.960]},
         'THR':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['1A1',[' HB '],[' CA ',' CG2',' OG1'],1.090],
                ' OG1':['1A3',[' HG1'],[' CB ',' CA '],0.960],
                ' CG2':['3A1',['HG21','HG22','HG23'],[' CB '],1.090]},
         'LEU':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CG ':['1A1',[' HG '],[' CB ',' CD1',' CD2'],1.090],
                ' CD1':['3A1',['HD11','HD12','HD13'],[' CG '],1.090],
                ' CD2':['3A1',['HD21','HD22','HD23'],[' CG '],1.090]},
         'ILE':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['1A1',[' HB '],[' CA ',' CG1',' CG2'],1.090],
                ' CG1':['2A1',['HG11','HG13'],[' CB ',' CD1'],1.090],
                ' CG2':['3A1',['HG21','HG22','HG23'],[' CB '],1.090],
                ' CD1':['3A1',['HD11','HD12','HD13'],[' CG1'],1.090]},
         'VAL':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['1A1',[' HB '],[' CA ',' CG1',' CG2'],1.090],
                ' CG1':['3A1',['HG11','HG12','HG13'],[' CB '],1.090],
                ' CG2':['3A1',['HG21','HG22','HG23'],[' CB '],1.090]},
         'ASN':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' ND2':['2A2',['HD21','HD22'],[' CG ',' OD1'],1.010]},
         'GLN':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CG ':['2A1',[' HG2',' HG3'],[' CB ',' CD '],1.090],
                ' NE2':['2A2',['HE21','HE22'],[' CD ',' OE1'],1.010]},
         'ARG':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CD ':['2A1',[' HD2',' HD3'],[' CG ',' NE '],1.090],
                ' CG ':['2A1',[' HG2',' HG3'],[' CB ',' CD '],1.090],
                ' NE ':['1A2',[' HE '],[' CD ',' CZ '],1.010],
                ' NH1':['2A2',['HH11','HH12'],[' CZ ',' NE '],1.010],
                ' NH2':['2A2',['HH21','HH22'],[' CZ ',' NE '],1.010]},
         'HID':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CD2':['1A2',[' HD2'],[' CG ',' NE2'],1.090],
                ' CE1':['1A2',[' HE1'],[' NE2',' ND1 '],1.090],
                ' ND1':['1A2',[' HD1'],[' CE1',' CG '],1.010],},
         'HIE':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CD2':['1A2',[' HD2'],[' CG ',' NE2'],1.090],
                ' CE1':['1A2',[' HE1'],[' NE2',' ND1 '],1.090],
                ' NE2':['1A2',[' HE2'],[' CE1',' CD2'],1.010],},
         'HIP':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CD2':['1A2',[' HD2'],[' CG ',' NE2'],1.090],
                ' CE1':['1A2',[' HE1'],[' NE2',' ND1 '],1.090],
                ' NE2':['1A2',[' HE2'],[' CE1',' CD2'],1.010],
                ' ND1':['1A2',[' HD1'],[' CG ',' CE1'],1.010],},
         'HIS':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CD2':['1A2',[' HD2'],[' CG ',' NE2'],1.090],
                ' CE1':['1A2',[' HE1'],[' ND1',' NE2'],1.090],
                ' NE2':['1A2',[' HE2'],[' CD2',' CE1'],1.010],
                ' ND1':['1A2',[' HD1'],[' CG ',' CE1'],1.010],},
         'TRP':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB1',' HB2'],[' CA ',' CG '],1.090],
                ' CD1':['1A2',[' HD1'],[' CG ',' NE1'],1.090],
                ' CZ2':['1A2',[' HZ2'],[' CE2',' CH2'],1.090],
                ' CZ3':['1A2',[' HZ3'],[' CE3',' CH2'],1.090],
                ' CH2':['1A2',[' HH2'],[' CZ2',' CZ3'],1.090],
                ' CE3':['1A2',[' HE3'],[' CZ3',' CD2'],1.090],
                ' NE1':['1A2',[' HE1'],[' CD1',' CE2'],1.010],},
         'PHE':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CD1':['1A2',[' HD1'],[' CG ',' CE1'],1.090],
                ' CE1':['1A2',[' HE1'],[' CD1',' CZ '],1.090],
                ' CZ ':['1A2',[' HZ '],[' CE1',' CE2'],1.090],
                ' CE2':['1A2',[' HE2'],[' CZ ',' CD2'],1.090],
                ' CD2':['1A2',[' HD2'],[' CE2',' CG '],1.090],},
         'TYR':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CD1':['1A2',[' HD1'],[' CG ',' CE1'],1.090],
                ' CD2':['1A2',[' HD2'],[' CG ',' CE2'],1.090],
                ' CE1':['1A2',[' HE1'],[' CD1',' CZ '],1.090],
                ' OH ':['1A3',[' HH '],[' CZ ',' CE2'],0.960],
                ' CE2':['1A2',[' HE2'],[' CZ ',' CD2'],1.090],},
         'GLU':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CG ':['2A1',[' HG2',' HG3'],[' CB ',' CD '],1.090]},
         'ASP':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090]},
         'LYS':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CG ':['2A1',[' HG2',' HG3'],[' CB ',' CD '],1.090],
                ' CD ':['2A1',[' HD2',' HD3'],[' CE ',' CG '],1.090],
                ' CE ':['2A1',[' HE2',' HE3'],[' CD ',' NZ '],1.090],
                ' NZ ':['3A1',[' HZ1',' HZ2',' HZ3'],[' CE ',' CD '],1.010]},
         'PRO':{' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CG ':['2A1',[' HG2',' HG3'],[' CB ',' CD '],1.090],
                ' CD ':['2A1',[' HD2',' HD3'],[' CG ',' N  '],1.090]},
         'CYS':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' SG '],1.090],
                ' SG ':['1A3',[' HG '],[' CB ',' CA '],1.330]},
         'CYX':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB1',' HB2'],[' CA ',' SG '],1.090]},
         'MET':{' N  ':['1A2',[' H  '],[' CA ','-C  '],1.010],
                ' CA ':['1A1',[' HA '],[' N  ',' C  ',' CB '],1.090],
                ' CB ':['2A1',[' HB2',' HB3'],[' CA ',' CG '],1.090],
                ' CG ':['2A1',[' HG2',' HG3'],[' CB ',' SD '],1.090],
                ' CE ':['3A1',[' HE1',' HE2',' HE3'],[' SD ',' CG '],1.090]},       
                }

# see ConvertPDBAtmNam method in fulib
AtmNamOldToNew={'1HB ':' HB1','2HB ':' HB2','3HB ':' HB3',
                '1HA ':' HA1','2HA ':' HA2',' HA3':' HA3',
                '1HG2':'HG21','2HG2':'HG22','3HG2':'HG23',
                '1HD1':'HD11','2HD1':'HD12','3HD1':'HD13',
                '1HD2':'HD21','2HD2':'HD22','3HD2':'HD23',
                '1HG1':'HG11','2HG1':'HG12','3HG1':'HG13',
                '1HG2':'HG21','2HG2':'HG22','3HG2':'HG23',
                '1HG ':' HG1','2HG ':' HG2','3HG ':' HG3',
                '1HE2':'HE21','2HE2':'HE22','3HE2':'HE23',
                '1HD ':' HD1','2HD ':' HD2','3HD ':' HD3',
                '1HH1':'HH11','2HH1':'HH12','3HH1':'HH13',
                '1HH2':'HH21','2HH2':'HH22','3HH2':'HH23',
                '1HE ':' HE1','2HE ':' HE2','3HE ':' HE3',
                '1HZ ':' HZ1','2HZ ':' HZ2','3HZ ':' HZ3'       
                }

AmiResBnd={'ALA':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ']},
           'VAL':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG1',' CG2'],
                  ' CG1':[' CB '],
                  ' CG2':[' CB ']},
           'ASP':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' OD1',' OD2'],
                  ' OD1':[' CG '],
                  ' OD2':[' CG ']},
           'GLY':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  ']},
           'ASN':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' ND2',' OD1'],
                  ' OD1':[' CG '],
                  ' ND2':[' CG ']},
           'HIS':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD2',' ND1'],
                  ' ND1':[' CG ',' CE1'],
                  ' CD2':[' CG ',' NE2'],
                  ' CE1':[' ND1',' NE2'],
                  ' NE2':[' CD2',' CE1']},
           'HID':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD2',' ND1'],
                  ' ND1':[' CG ',' CE1'],
                  ' CD2':[' CG ',' NE2'],
                  ' CE1':[' ND1',' NE2'],
                  ' NE2':[' CD2',' CE1']},
           'HIE':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD2',' ND1'],
                  ' ND1':[' CG ',' CE1'],
                  ' CD2':[' CG ',' NE2'],
                  ' CE1':[' ND1',' NE2'],
                  ' NE2':[' CD2',' CE1']},

           'LYS':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD '],
                  ' CD ':[' CG ',' CE '],
                  ' CE ':[' CD ',' NZ '],
                  ' NZ ':[' CE ']},
           'SER':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' OG '],
                  ' OG ':[' CB ']},
           'GLN':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD '],
                  ' CD ':[' CG ',' NE2',' OE1'],
                  ' OE1':[' CD '],
                  ' NE2':[' CD ']},
           'TRP':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD1',' CD2'],
                  ' CD1':[' CG ',' NE1'],
                  ' CD2':[' CG ',' CE2',' CE3'],
                  ' NE1':[' CD1',' CE2'],
                  ' CE2':[' CD2',' NE1',' CZ2'],
                  ' CE3':[' CD2',' CZ3'],
                  ' CZ2':[' CE2',' CH2'],
                  ' CZ3':[' CE3',' CH2'],
                  ' CH2':[' CZ2',' CZ3']},
           'PRO':{' N  ':['-C  ',' CA ',' CD '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD '],
                  ' CD ':[' N  ',' CG ']},
           'THR':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' OG1',' CG2'],
                  ' OG1':[' CB '],
                  ' CG2':[' CB ']},
           'ARG':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD '],
                  ' CD ':[' CG ',' NE '],
                  ' NE ':[' CD ',' CZ '],
                  ' CZ ':[' NE ',' NH1',' NH2'],
                  ' NH1':[' CZ '],
                  ' NH2':[' CZ ']},
           'PHE':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD1',' CD2'],
                  ' CD1':[' CG ',' CE1'],
                  ' CD2':[' CG ',' CE2'],
                  ' CE1':[' CD1',' CZ '],
                  ' CE2':[' CD2',' CZ '],
                  ' CZ ':[' CE1',' CE2']},
           'CYS':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' SG '],
                  ' SG ':[' CB ']},
           'CYX':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' SG '],
                  ' SG ':[' CB ']},

           'LEU':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD1',' CD2'],
                  ' CD1':[' CG '],
                  ' CD2':[' CG ']},
           'TYR':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD1',' CD2'],
                  ' CD1':[' CG ',' CE1'],
                  ' CD2':[' CG ',' CE2'],
                  ' CE1':[' CD1',' CZ '],
                  ' CE2':[' CD2',' CZ '],
                  ' CZ ':[' CE1',' CE2',' OH '],
                  ' OH ':[' CZ ']},
           'ILE':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG1',' CG2'],
                  ' CG1':[' CB ',' CD1'],
                  ' CG2':[' CB '],
                  ' CD1':[' CG1']},
           'GLU':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' CD '],
                  ' CD ':[' CG ',' OE1',' OE2'],
                  ' OE1':[' CD '],
                  ' OE2':[' CD ']},
           'MET':{' N  ':['-C  ',' CA '],
                  ' CA ':[' N  ',' C  ',' CB '],
                  ' C  ':[' CA ','+N  ',' O  '],
                  ' O  ':[' C  '],
                  ' CB ':[' CA ',' CG '],
                  ' CG ':[' CB ',' SD '],
                  ' SD ':[' CG ',' CE '],
                  ' CE ':[' SD ']}
           }       

AmiResBndNmb={'ALA':{' N  ':2,' CA ':3,' C  ':3,' O  ':1,' CB ':1},
           'VAL':{' N  ':2,' CA ':3,' C  ':3,' O  ':1,' CB ':3,
                  ' CG1':1,' CG2':1},
           'ASP':{' N  ':2,' CA ':3,' C  ':3,' O  ':1,' CB ':2,
                  ' CG ':3,' OD1':1,' OD2':1},
           'GLY':{' N  ':2,
                  ' CA ':2,
                  ' C  ':3,
                  ' O  ':1},
           'ASN':{' N  ':2,
                  ' CA ':3, #[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' ND2',' OD1'],
                  ' OD1':1,#[' CG '],
                  ' ND2':1},#[' CG ']},
           'HIS':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' CD2',' ND1'],
                  ' ND1':2,#[' CG ',' CE1'],
                  ' CD2':2,#[' CG ',' NE2'],
                  ' CE1':2,#[' ND1',' NE2'],
                  ' NE2':2},#[' CD2',' CE1']},
           'HIP':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' CD2',' ND1'],
                  ' ND1':2,#[' CG ',' CE1'],
                  ' CD2':2,#[' CG ',' NE2'],
                  ' CE1':2,#[' ND1',' NE2'],
                  ' NE2':2},#[' CD2',' CE1']},
           'HID':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' CD2',' ND1'],
                  ' ND1':2,#[' CG ',' CE1'],
                  ' CD2':2,#[' CG ',' NE2'],
                  ' CE1':2,#[' ND1',' NE2'],
                  ' NE2':2},#[' CD2',' CE1']},
           'HIE':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' CD2',' ND1'],
                  ' ND1':2,#[' CG ',' CE1'],
                  ' CD2':2,#[' CG ',' NE2'],
                  ' CE1':2,#[' ND1',' NE2'],
                  ' NE2':2},#[' CD2',' CE1']},
           'LYS':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':2,#[' CB ',' CD '],
                  ' CD ':2,#[' CG ',' CE '],
                  ' CE ':2,#[' CD ',' NZ '],
                  ' NZ ':1},#[' CE ']},
           'SER':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' OG '],
                  ' OG ':1},#[' CB ']},
           'GLN':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':2,#[' CB ',' CD '],
                  ' CD ':3,#[' CG ',' NE2',' OE1'],
                  ' OE1':1,#[' CD '],
                  ' NE2':1},#[' CD ']},
           'TRP':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' CD1',' CD2'],
                  ' CD1':2,#[' CG ',' NE1'],
                  ' CD2':3,#[' CG ',' CE2',' CE3'],
                  ' NE1':2,#[' CD1',' CE2'],
                  ' CE2':3,#[' CD2',' NE1',' CZ2'],
                  ' CE3':2,#[' CD2',' CZ3'],
                  ' CZ2':2,#[' CE2',' CH2'],
                  ' CZ3':2,#[' CE3',' CH2'],
                  ' CH2':2},#[' CZ2',' CZ3']},
           'PRO':{' N  ':3,#['-C  ',' CA ',' CD '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':2,#[' CB ',' CD '],
                  ' CD ':2},#[' N  ',' CG ']},
           'THR':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':3,#[' CA ',' OG1',' CG2'],
                  ' OG1':1,#[' CB '],
                  ' CG2':1},#[' CB ']},
           'ARG':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':2,#[' CB ',' CD '],
                  ' CD ':2,#[' CG ',' NE '],
                  ' NE ':2,#[' CD ',' CZ '],
                  ' CZ ':3,#[' NE ',' NH1',' NH2'],
                  ' NH1':1,#[' CZ '],
                  ' NH2':1},#[' CZ ']},
           'PHE':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' CD1',' CD2'],
                  ' CD1':2,#[' CG ',' CE1'],
                  ' CD2':2,#[' CG ',' CE2'],
                  ' CE1':2,#[' CD1',' CZ '],
                  ' CE2':2,#[' CD2',' CZ '],
                  ' CZ ':2},#[' CE1',' CE2']},
           'CYS':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' SG '],
                  ' SG ':1},#[' CB ']},
           'CYX':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' SG '],
                  ' SG ':1},#[' CB ']},
           'LEU':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' CD1',' CD2'],
                  ' CD1':1,#[' CG '],
                  ' CD2':1},#[' CG ']},
           'TYR':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':3,#[' CB ',' CD1',' CD2'],
                  ' CD1':2,#[' CG ',' CE1'],
                  ' CD2':2,#[' CG ',' CE2'],
                  ' CE1':2,#[' CD1',' CZ '],
                  ' CE2':2,#[' CD2',' CZ '],
                  ' CZ ':3,#[' CE1',' CE2',' OH '],
                  ' OH ':1}, #[' CZ ']},
           'ILE':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':3,#[' CA ',' CG1',' CG2'],
                  ' CG1':2,#[' CB ',' CD1'],
                  ' CG2':1,#[' CB '],
                  ' CD1':1},#[' CG1']},
           'GLU':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':2,#[' CB ',' CD '],
                  ' CD ':3,#[' CG ',' OE1',' OE2'],
                  ' OE1':1,#[' CD '],
                  ' OE2':1},#[' CD ']},
           'MET':{' N  ':2,#['-C  ',' CA '],
                  ' CA ':3,#[' N  ',' C  ',' CB '],
                  ' C  ':3,#[' CA ','+N  ',' O  '],
                  ' O  ':1,#[' C  '],
                  ' CB ':2,#[' CA ',' CG '],
                  ' CG ':2,#[' CB ',' SD '],
                  ' SD ':2,#[' CG ',' CE '],
                  ' CE ':1}#[' SD ']}
           }       


AmiResAtmChg={'ASP':{' OD1':-0.501,' OD2':-0.501},
              'LYS':{' HZ1':+0.334,' HZ2':+0.334,' HZ3':+0.334},
              'ARG':{' NH1':0.501,' NH2':0.501},
              'GLU':{' OE1':-0.501,' OE2':-0.501},
              'HIS':{' ND1':+0.501,' NE2':+0.501} }

#AmiResAtmChg={'ASP':{' OD1':-0.501,' OD2':-0.501},
#              'LYS':{'1HZ ':+0.334,'2HZ ':+0.334,'3HZ ':+0.334},
#              'ARG':{' NH1':0.501,' NH2':0.501},
#              'GLU':{' OE1':-0.501,' OE2':-0.501},
#              'HIS':{' ND1':+0.501,' NE2':+0.501} }       

AmiResNmbH={'GLY':3,'ALA':5,'VAL':9,'PHE':9,'ILE':11,
            'LEU':11,'PRO':7,'MET':9,'ASP':4,'GLU':6,
            'LYS':13,'ARG':13,'SER':5,'THR':7,'TYR':9,
            'CYS':5,'ASN':6,'GLN':8,'HIS':7,'TRP':10,
            'ACE':3,'NME':4}
AmiResChainBnd={' N   C  ': 1,' N   CA ': 2,' CA  C  ': 3,' CA  N  ': 4,
                ' C   N  ': 5,' C   CA ': 6,' C   N  ': 7,' CA  N  ': 8,
                ' C   CA ': 9,' N   CA ':10,' N   C  ':11,' CA  C  ':12}

# CAATION! the following data are not varidated and temporal.
IonAtmChg={'H+':{'H+  ':+1.0,'H-  ':-1.0},'LI':{'LI  ':+1.0},
           'NA':{'NA  ':+1.0},'KA':{'KA  ':+1.0},'AL':{'AL  ':+3.0},
           'MG':{'MG  ':+2.0},'CA':{'CA  ':+2.0},'SR':{'SR  ':+2.0},
           'BA':{'BA  ':+2.0},'CD':{'CD  ':+2.0},'NI':{'NI  ':+2.0},
           'ZN':{'ZN  ':+2.0},'CU':{'CU  ':+2.0},'HG':{'HG  ':+2.0},
           'FE':{'FE  ':+2.0,'FE2 ':+2.0,' FE3':+3.0},
           'CO':{'CO  ':+2.0},'CR':{'CR  ':+3.0},
           'SN':{'SN  ':+2.0},'PB':{'PB  ':+2.0},
           'MN':{'MN  ':+2.0,'MN2 ':+2.0,'MN3 ':+3.0},
           'F-':{' F  ':-1.0},'CL':{'CL  ':-1.0},'BR':{'BR  ':-1.0},
           'I-':{' I  ':-1.0},'O-':{' O  ':-2.0},'S-':{' S  ':-2.0}
           }

CationChg={'LI':+1.0,'NA':+1.0,
           'KA':+1.0,'AL':+3.0,
           'MG':+2.0,'CA':+2.0,'SR':+2.0,
           'BA':+2.0,'CD':+2.0,'NI':+2.0,
           'ZN':+2.0,'CU':+2.0,'HG':+2.0,
           'FE':+2.0,
           'CO':+2.0,'CR':+3.0,
           'SN':+2.0,'PB':+2.0,
           'MN':+2.0
           }

AnionChg= {' F':-1.0,'CL':-1.0,'BR':-1.0,' I':-1.0,
           ' O':-2.0,' S':-2.0 }

# ionization potential
ipdic={' H':13.598,'HE':24.587,'LI': 5.392,'BE': 9.322,' B': 8.298,
       ' C':11.260,' N':14.534,' O':13.618,' F':17.422,'NE':21.564,
       'NA': 5.139,'MG': 7.646,'AL': 5.986,'SI': 8.152,' P':10.486,
       ' S':10.360,'CL':12.967,'AR':15.760,' K': 4.341,'CA': 6.113,
       'SC': 6.540,'TI': 9.820,' V': 6.740,'CR': 6.766,'MN':7.435,
       'FE': 7.870,'CO': 7.864,'NI': 7.635,'CU': 7.726,'ZN':9.394,
       'GA': 5.999,'GE': 7.899,'AS': 9.810,'SE': 9.752,'BR':11.814,
       'KR':13.999,'RB': 4.177,'SR': 5.695,' Y': 6.380,'ZR': 6.840,
       'NB': 6.880,'MO': 7.099,'TC': 7.280,'RU': 7.370,'RH': 7.460,
       'PD': 8.340,'AG': 7.576,'CD': 8.993,'IN': 5.786,'SN': 7.344,
       'SB': 8.641,'TE': 9.009,' I':10.451,'XE':12.130,'CS': 3.894,
       'BA': 5.212,'LA': 5.577,'CE': 5.539,'PR': 5.464,'ND': 5.525,
       'PM': 5.582,'SM': 5.644,'EU': 5.670,'GD': 6.150,'TB': 5.864,
       'DY': 5.939,'HO': 6.022,'ER': 6.108,'TM': 6.180,'YB': 6.254,
       'LU': 5.426,'HF': 6.780,'TA': 7.400,' W': 7.600,'RE': 7.760,
       'OS': 8.280,'IR': 9.020,'PT': 8.610,'AU': 9.225,'HG':10.437,
       'TL': 6.108,'PB': 7.416,'BI': 7.289,'PO': 8.420,'AT': 9.228,'RN':10.748}
# electron affinity
eadic={' H': 0.754,'HE': 0.00,'LI':  0.6180,'BE':0.0,  ' B': 0.277,
       ' C': 1.263,' N':-0.07,' O':  1.461, ' F':3.399,'NE': 0.0,
       'NA': 0.548,'MG': 0.0, 'AL':  0.441, 'SI':1.385,' P': 0.746,
       ' S': 2.077,'CL': 3.617,'AR': 0.0,   ' K':0.501,'CA': 0.0,
       'SC': 0.188,'TI':  0.079,' V': 0.525,'CR':0.666,'MN': 0.0,
       'FE': 0.163,'CO':  0.661,'NI': 1.156,'CU':1.228,'ZN': 0.0,
       'GA': 0.30, 'GE':  1.2,  'AS': 0.81, 'SE':2.02, 'BR': 3.365,
       'KR': 0.0,  'RB':  0.486,'SR': 0.0,  ' Y':0.307, 'ZR':0.426,
       'NB': 0.893,'MO':  0.746,'TC': 0.55, 'RU':1.05,  'RH':1.137,
       'PD': 0.557,'AG':  1.302,'CD': 0.0,  'IN':0.3,   'SN':1.2,
       'SB': 1.07, 'TE':  1.971,' I': 3.059,'XE':0.0,   'CS':0.472,
       'BA': 0.0,  'LA':  0.5,  'CE': 0.5,  'PR':0.5,   'ND':0.5,
       'PM': 0.5,  'SM':  0.5,  'EU': 0.5,  'GD':0.5,   'TB':0.5,
       'DY': 0.5,  'HO':  0.5,  'ER': 0.5,  'TM':0.5,   'YB':0.5,
       'LU': 0.5,  'HF':  0.0,  'TA': 0.322,' W':0.815, 'RE':0.15,
       'OS': 1.1,  'IR':  1.565,'PT': 2.128,'AU':2.308, 'HG':0.0,
       'TL': 0.2,  'PB':  0.364,'BI': 0.946,'PO':1.9,   'AT':2.8,  'RN':0.0}
#

# hybrid orbital name: element name(i.e. " C")+basis set name(i.e. "STO-3G")
# the hybrid orbitals of carbon were taken from NLMOs of CH4 molecule.
""" these should be in a file """
HybOrb={'MINI': [['-0.104883',' 0.308874',' 0.000000',' 0.000000',' 0.521806'],
                 ['-0.104884',' 0.308875',' 0.491962',' 0.000000','-0.173935'],
                 ['-0.104884',' 0.308876','-0.245981','-0.426051','-0.173934'],
                 ['-0.104884',' 0.308876','-0.245981',' 0.426051','-0.173934'],
                 [' 0.988209',' 0.063992',' 0.000000',' 0.000000',' 0.000000']],
        'STO-3G':[['-0.117784',' 0.542251',' 0.000000',' 0.000000',' 0.850774'],
                  ['-0.117787',' 0.542269',' 0.802107',' 0.000000','-0.283586'],
                  ['-0.117787',' 0.542269','-0.401054','-0.694646','-0.283586'],
                  ['-0.117787',' 0.542269','-0.401054',' 0.694646','-0.283586'],
                  [' 1.003621','-0.015003',' 0.000000',' 0.000000',' 0.000000']],
        '6-31G': [['-0.067724',' 0.300281',' 0.000000',' 0.000000',' 0.606750',
                     ' 0.306535',' 0.000000',' 0.000000',' 0.309793'],
                  ['-0.067730',' 0.300310',' 0.572037',' 0.000000','-0.202234',
                   ' 0.306552',' 0.292061',' 0.000000','-0.103255'],
                  ['-0.067730',' 0.300310','-0.286019','-0.495398','-0.202234',
                   ' 0.306552','-0.146031','-0.252933','-0.103255'],
                  ['-0.067730',' 0.300310','-0.286019',' 0.495398','-0.202234',
                   ' 0.306552','-0.146031',' 0.252933','-0.103255'],
                  [' 1.011954','-0.016447',' 0.000000',' 0.000000',' 0.000000',
                   '-0.059374',' 0.000000',' 0.000000','-0.000001']],
      '6-31G*':[['-0.065034',' 0.288264',' 0.000000',' 0.000000',' 0.604413',
                 ' 0.290129',' 0.000000',' 0.000000',' 0.319045','-0.017106',
                 '-0.017106',' 0.057935',' 0.000000',' 0.000000',' 0.000000'],
                ['-0.065041',' 0.288294',' 0.569833',' 0.000000','-0.201457',
                 ' 0.290147',' 0.300784',' 0.000000','-0.106342',' 0.049599',
                 '-0.017106','-0.008771',' 0.000000','-0.027223',' 0.000000'],
                ['-0.065040',' 0.288293','-0.284917','-0.493490','-0.201456',
                 ' 0.290146','-0.150393','-0.260487','-0.106341','-0.000428',
                 ' 0.032923','-0.008771',' 0.033353',' 0.013612',' 0.023577'],
                ['-0.065040',' 0.288293','-0.284917',' 0.493490','-0.201456',
                 ' 0.290146','-0.150393',' 0.260487','-0.106341','-0.000428',
                 ' 0.032923','-0.008771','-0.033353',' 0.013612','-0.023577'],
                [' 1.010938','-0.011976',' 0.000000',' 0.000000',' 0.000000',
                 '-0.054085',' 0.000000',' 0.000000','-0.000001','-0.003175',
                 '-0.003175','-0.003175',' 0.000000',' 0.000000',' 0.000000']]
         # 'ccpVDZ'
         # 'ccpVTZ'
         # 'augccpVDZ'
         # 'augccpVTZ'
        }      

ViewDefaultParams={
        'bgcolor':[0.0, 0.0, 0.0, 1.0], # background color: black
        'rad_stick':0.2, # stick thickness
        'rad_ball':0.4, # ball rdius
        'rad_cpk_scale':1.0, # CPK radius scale
        'rad_tube':0.2, # chain tube thickness
        'stereo':0 # stereo view, 0:off, 1:cross-eye, 2: parallel eye
        }

